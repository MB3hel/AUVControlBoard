Adapted from SAMD21 stack https://github.com/kevinmehall/usb